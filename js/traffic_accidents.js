var data = [{ "pid": 110000, "income": [{ "county": 1, "money": 48531.85 }, { "county": 2, "money": 18867.3 }], "expend": [{ "county": 1, "money": 33717.45 }, { "county": 2, "money": 14535.06 }] }, { "pid": 310000, "income": [{ "county": 1, "money": 48841.4 }, { "county": 2, "money": 21191.64 }], "expend": [{ "county": 1, "money": 35182.44 }, { "county": 2, "money": 14820.08 }] }, { "pid": 120000, "income": [{ "county": 1, "money": 31506.03 }, { "county": 2, "money": 17014.18 }], "expend": [{ "county": 1, "money": 24289.64 }, { "county": 2, "money": 13738.62 }] }, { "pid": 500000, "income": [{ "county": 1, "money": 25147.23 }, { "county": 2, "money": 9489.82 }], "expend": [{ "county": 1, "money": 18279.49 }, { "county": 2, "money": 7982.56 }] }, { "pid": 130000, "income": [{ "county": 1, "money": 24141.34 }, { "county": 2, "money": 10186.14 }], "expend": [{ "county": 1, "money": 16203.82 }, { "county": 2, "money": 8247.99 }] }, { "pid": 140000, "income": [{ "county": 1, "money": 24069.43 }, { "county": 2, "money": 8809.44 }], "expend": [{ "county": 1, "money": 14636.88 }, { "county": 2, "money": 6991.69 }] }, { "pid": 220000, "income": [{ "county": 1, "money": 23217.82 }, { "county": 2, "money": 10780.12 }], "expend": [{ "county": 1, "money": 17156.14 }, { "county": 2, "money": 8139.82 }] }, { "pid": 230000, "income": [{ "county": 1, "money": 22609.03 }, { "county": 2, "money": 10453.2 }], "expend": [{ "county": 1, "money": 16466.63 }, { "county": 2, "money": 7829.99 }] }, { "pid": 320000, "income": [{ "county": 1, "money": 34346.26 }, { "county": 2, "money": 14958.44 }], "expend": [{ "county": 1, "money": 23476.28 }, { "county": 2, "money": 11820.27 }] }, { "pid": 350000, "income": [{ "county": 1, "money": 30722.39 }, { "county": 2, "money": 12650.19 }], "expend": [{ "county": 1, "money": 22204.06 }, { "county": 2, "money": 11055.93 }] }, { "pid": 360000, "income": [{ "county": 1, "money": 24309.19 }, { "county": 2, "money": 10116.58 }], "expend": [{ "county": 1, "money": 15141.78 }, { "county": 2, "money": 7548.26 }] }, { "pid": 370000, "income": [{ "county": 1, "money": 29221.94 }, { "county": 2, "money": 11882.26 }], "expend": [{ "county": 1, "money": 18322.6 }, { "county": 2, "money": 7962.23 }] }, { "pid": 420000, "income": [{ "county": 1, "money": 24852.28 }, { "county": 2, "money": 10849.06 }], "expend": [{ "county": 1, "money": 16681.41 }, { "county": 2, "money": 8680.93 }] }, { "pid": 430000, "income": [{ "county": 1, "money": 26570.16 }, { "county": 2, "money": 10060.17 }], "expend": [{ "county": 1, "money": 18334.66 }, { "county": 2, "money": 9024.84 }] }, { "pid": 460000, "income": [{ "county": 1, "money": 24486.53 }, { "county": 2, "money": 9912.57 }], "expend": [{ "county": 1, "money": 17513.78 }, { "county": 2, "money": 7028.97 }] }, { "pid": 510000, "income": [{ "county": 1, "money": 24234.41 }, { "county": 2, "money": 9347.74 }], "expend": [{ "county": 1, "money": 17759.93 }, { "county": 2, "money": 8301.1 }] }, { "pid": 520000, "income": [{ "county": 1, "money": 22548.21 }, { "county": 2, "money": 6671.22 }], "expend": [{ "county": 1, "money": 15254.64 }, { "county": 2, "money": 5970.25 }] }, { "pid": 610000, "income": [{ "county": 1, "money": 24365.76 }, { "county": 2, "money": 7932.21 }], "expend": [{ "county": 1, "money": 17545.96 }, { "county": 2, "money": 7252.37 }] }, { "pid": 620000, "income": [{ "county": 1, "money": 21803.86 }, { "county": 2, "money": 6276.59 }], "expend": [{ "county": 1, "money": 15942.25 }, { "county": 2, "money": 6147.78 }] }, { "pid": 150000, "income": [{ "county": 1, "money": 28349.64 }, { "county": 2, "money": 9976.3 }], "expend": [{ "county": 1, "money": 20885.23 }, { "county": 2, "money": 9972.24 }] }, { "pid": 210000, "income": [{ "county": 1, "money": 29081.75 }, { "county": 2, "money": 11191.49 }], "expend": [{ "county": 1, "money": 20519.57 }, { "county": 2, "money": 7800.75 }] }, { "pid": 330000, "income": [{ "county": 1, "money": 40392.72 }, { "county": 2, "money": 19373.28 }], "expend": [{ "county": 1, "money": 27241.74 }, { "county": 2, "money": 14497.81 }] }, { "pid": 340000, "income": [{ "county": 1, "money": 24838.52 }, { "county": 2, "money": 9916.42 }], "expend": [{ "county": 1, "money": 16107.07 }, { "county": 2, "money": 7980.76 }] }, { "pid": 410000, "income": [{ "county": 1, "money": 23672.06 }, { "county": 2, "money": 9966.07 }], "expend": [{ "county": 1, "money": 16184.46 }, { "county": 2, "money": 7277.21 }] }, { "pid": 440000, "income": [{ "county": 1, "money": 32148.11 }, { "county": 2, "money": 12245.56 }], "expend": [{ "county": 1, "money": 23611.74 }, { "county": 2, "money": 10043.21 }] }, { "pid": 450000, "income": [{ "county": 1, "money": 24669 }, { "county": 2, "money": 8683.18 }], "expend": [{ "county": 1, "money": 15045.4 }, { "county": 2, "money": 6675.07 }] }, { "pid": 530000, "income": [{ "county": 1, "money": 24299.01 }, { "county": 2, "money": 7456.13 }], "expend": [{ "county": 1, "money": 16268.33 }, { "county": 2, "money": 6030.26 }] }, { "pid": 540000, "income": [{ "county": 1, "money": 22015.81 }, { "county": 2, "money": 7359.2 }], "expend": [{ "county": 1, "money": 15669.36 }, { "county": 2, "money": 4822.08 }] }, { "pid": 630000, "income": [{ "county": 1, "money": 22306.57 }, { "county": 2, "money": 7282.73 }], "expend": [{ "county": 1, "money": 17492.89 }, { "county": 2, "money": 8235.14 }] }, { "pid": 640000, "income": [{ "county": 1, "money": 23284.56 }, { "county": 2, "money": 8410.02 }], "expend": [{ "county": 1, "money": 17216.23 }, { "county": 2, "money": 7676.49 }] }, { "pid": 650000, "income": [{ "county": 1, "money": 23214.03 }, { "county": 2, "money": 8723.83 }], "expend": [{ "county": 1, "money": 17684.52 }, { "county": 2, "money": 7365.32 }] }]
$(function () {//UI变化
    var trafficeType = $('select[name^=trafficType] option:selected').val()
    switch (trafficeType){
        case '残疾赔偿金':
            $('.form-box-item').show()
            $('#bfyrBox').hide()
            $('#cdyw').hide()
            break
        case '死亡赔偿金':
            $('.form-box-item').show()
            $('#bfyrBox').hide()
            $('#scdj').hide()
            $('#ylfy').hide()
            $('#yx').hide()
            $('#wgts').hide()
            $('#cdyw').hide()
            break
        case '被抚养人生活费':
            $('.form-box-item').show()
            $('#shznl').hide()
            $('#ylfy').hide()
            $('#yx').hide()
            $('#wgts').hide()
            break
        case '丧葬费':
            $('.form-box-item').show()
            $('#bfyrBox').hide()
            $('#scdj').hide()
            $('#shznl').hide()
            $('#ylfy').hide()
            $('#yx').hide()
            $('#wgts').hide()
            $('#cdyw').hide()
            break
    }
})
$('#trafficType').change(function () {//ui变化
    var trafficeType = $('select[name^=trafficType] option:selected').val()
    switch (trafficeType){
        case '残疾赔偿金':
            $('.form-box-item').show()
            $('#bfyrBox').hide()
            $('#cdyw').hide()
            break
        case '死亡赔偿金':
            $('.form-box-item').show()
            $('#bfyrBox').hide()
            $('#scdj').hide()
            $('#ylfy').hide()
            $('#yx').hide()
            $('#wgts').hide()
            $('#cdyw').hide()
            break
        case '被抚养人生活费':
            $('.form-box-item').show()
            $('#shznl').hide()
            $('#ylfy').hide()
            $('#yx').hide()
            $('#wgts').hide()
            break
        case '丧葬费':
            $('.form-box-item').show()
            $('#bfyrBox').hide()
            $('#scdj').hide()
            $('#shznl').hide()
            $('#ylfy').hide()
            $('#yx').hide()
            $('#wgts').hide()
            $('#cdyw').hide()
            break
    }
})
$('#submitFees').click(function () {
    var trafficeType = $('select[name^=trafficType] option:selected').val()
    var level = ($('select[name^=degree] option:selected').val() - 0)/100     //伤残等级
    var age = $('#age').val()                                                 //受害人年龄
    var pid = $('select[name^=location] option:selected').val()               //受诉法院
    var home = $('select[name^=home] option:selected').val()                  //户口类别
    var yl =  $('#ylmoney').val()                                             //医疗费用
    var yx =  $('#yxmoney').val()                                             //月薪
    var days =  $('#daynum').val()                                             //误工天数
    var fy = 0;
    var wg = 0;
    var all = 0;
    switch (trafficeType){
        case '残疾赔偿金':
            if (!/^\d+$/.test(age)) {
                alert('请输入正确的年龄');
                return false;
            }
            if (pid <= 0) {
                alert('请选择受诉法院地址');
                return false;
            }
            age = getole(age)
            var income = getincome(pid,home)
            fy = (income * age * level).toFixed(2);
            all = fy
            if (yl.length > 0) {
                if (!/^\d+(\.\d+)?$/.test(yl)) {
                    alert('请输入正确的医疗费用金额');
                    return false;
                }
            } else {
                $('#ylmoney').val('0')
            }
            all = (all-0) + (yl - 0);
            if (yx.length > 0) {
                if (!/^\d+(\.\d+)?$/.test(yx)) {
                    alert('请输入正确的月薪金额');
                    return false;
                }
            } else {
               $('#yxmoney').val('0')
            }
            all = (all - 0) + (yx - 0);
            if (days.length > 0) {
                if (!/^\d+$/.test(days)) {
                    alert('请输入正确的天数');
                    return false;
                }
            } else {
                $('#daynum').val('0');
            }
            if (days.length > 3) {
                days = '999';
                $('#daynum').val(days);
            }
            wg = (((days - 0) / 30) * (yx-0)).toFixed(2);
            all = ((all - 0) + (wg - 0)).toFixed(2);
            if(yl==''||yl==null||yl=='0'){
                yl='0.00'
            }
            var Html='<div class="jsjg-content"><h2 class="tc w100 color-1b0000 jsjg-title">计算结果</h2>' +
                '<p class="jsjg-detail tl pl10">医疗费用（元）：<span class="fr tr pr15">'+yl+'元</span></p>' +
                '<p class="jsjg-detail tl pl10">误工费用（元）：<span class="fr tr pr15">'+wg+'元</span></p>' +
                '<p class="jsjg-detail tl pl10">赔偿费用（元）：<span class="fr tr pr15">'+fy+'元</span></p>' +
                '<p class="jsjg-detail tl pl10">总计（元）：<span class="fr tr pr15">'+all+'元</span></p>' +
                '</div>'

            layer.open({
                content: Html
            });
            break
        case '死亡赔偿金':
            if (!/^\d+$/.test(age)) {
                alert('请输入正确的年龄');
                return false;
            }
            age = getole1(age);
            if (pid <= 0) {
               alert('请选择受诉法院地址');
                return false;
            }
            var income = getincome(pid, home);
            console.log(income)
            console.log(age)
            fy = (income * age).toFixed(2);
            var Html='<div class="jsjg-content"><h2 class="tc w100 color-1b0000 jsjg-title">计算结果</h2>' +
                '<p class="jsjg-detail tl pl10">赔偿金（元）：<span class="fr tr pr15">'+fy+'元</span></p>' +
                '</div>'

            layer.open({
                content: Html
            });
            break
        case '被抚养人生活费':
            if (!/^\d+$/.test(age)) {
                alert('请输入正确的年龄');
                return false;
            }
            age = getole2((age - 1));
            if (pid <= 0) {
               alert('请选择受诉法院地址');
                return false;
            }
            var people= $('#cdywrs').val()
            if (!/^\d+$/.test(people)) {
                alert('请输入正确的人数');
                return false;
            }
            if (people.length > 2) {
                $('#cdywrs').val('99')
            }
            var put = getput(pid, home);
            fy = (put * age / (people - 0) * level).toFixed(2);
            var Html='<div class="jsjg-content"><h2 class="tc w100 color-1b0000 jsjg-title">计算结果</h2>' +
                '<p class="jsjg-detail tl pl10">赔偿金（元）：<span class="fr tr pr15">'+fy+'元</span></p>' +
                '</div>'

            layer.open({
                content: Html
            });
            break
        case '丧葬费':
            if(pid<=0){
                alert('请选择受诉法院地址')
                return false
            }
            var income = getincome(pid,home)
            fy = (income*0.5).toFixed(2)
            var Html='<div class="jsjg-content"><h2 class="tc w100 color-1b0000 jsjg-title">计算结果</h2>' +
                '<p class="jsjg-detail tl pl10">赔偿金（元）：<span class="fr tr pr15">'+fy+'元</span></p>' +
                '</div>'

            layer.open({
                content: Html
            });
            break
    }
})


function getole(old) {
    var a = 0;
    if (old > 0 && old <= 60)
        a = 20;
    else if (old > 60 && old <= 75)
        a = 80 - old;
    else if (old > 75)
        a = 5;
    return a;
}
function getole1(old) {
    var a = 0;
    if (old > 0 && old <= 60)
        a = 20;
    else if (old > 60 && old <= 75)
        a = 20 - (old-60);
    else if (old > 75)
        a = 5;
    return a;
}
function getole2(old) {
    var a = 0;
    if (old > 0 && old <18)
        a = 18 - old;
    else if (old >=18 && old < 60)
        a = 20;
    else if (old >= 60 && old < 75)
        a = 80-old;
    else if (old <= 75)
        a = 5;
    return a;
}

function getincome(pid, home) {
    var a= 0
    for (var i=0;i<data.length;i++){
        if(data[i].pid == pid){
            for(var v=0;v<data[i].income.length;v++){
                if(home == data[i].income[v].county){
                    a= data[i].income[v].money
                }
            }
        }
    }
    console.log(a)
    return a;
}
function getput(pid,home) {
    var a = 0
    for(var i=0;i<data.length;i++){
        if(data[i].pid == pid){
            for(var v=0;v<data[i].expend.length;v++){
                if(home == data[i].expend[v].county){
                    a = data[i].expend[v].money
                }
            }
        }
    }
    console.log(a)
    return a
}

